# 高中电磁学 3D 课堂演示平台

这是一套面向课堂的 3D 物理演示工具。  
核心目标很简单: 让老师在一块屏幕里，直观展示电磁学中的“结构 + 过程 + 结果”。

## 你能直接演示什么

- 示波器: 电子束偏转、荧光屏轨迹、常见波形（正弦/方波/锯齿/三角）与自定义函数。
- 回旋加速器: 带电粒子轨道、交变电场加速、`U-t` 和 `Ek-t` 曲线联动。
- 磁流体发电机: 磁场中流体发电过程，参数变化与两端电压实时对应。
- 奥斯特实验: 电流磁效应、导线姿态变化、三枚磁针偏转和磁感线观察。

## 课堂上手（3 分钟）

1. 安装 Node.js（建议 20+ 版本）。
2. 在项目目录执行:
```bash
npm install
npm run dev
```
3. 浏览器打开终端显示的本地地址（通常是 `http://localhost:5173`）。
4. 进入“演示导航”，选择要讲的实验。

## 操作方式（全场景统一）

- 左侧是参数面板，右侧是 3D 演示区。
- 动画默认是暂停状态，点击“播放”开始演示。
- 鼠标:
  - 左键拖拽: 旋转
  - 滚轮: 缩放
  - 右键拖拽: 平移
- 触控:
  - 单指旋转
  - 双指缩放/平移
  - 双击重置视角
  - 画布区域手势优先（画布外仍可纵向滚动页面）
- 顶部可切换“白天模式 / 夜间模式”。
- “课堂展示”支持混合布局:
  - `自动`: 系统按左侧信息密度自动判断是否保留双核心布局
  - `双核心`: 强制保留“信息区 + 3D 视口”并排
  - `视口优先`: 强制 3D 视口优先，参数区可按需展开
- 如果某个演示运行异常，会显示降级卡片，可直接“重试场景”或“返回导航”。
- 常用快捷键:
  - `1-4`: 从导航页快速进入对应实验
  - `D / N`: 白天 / 夜间模式
  - `M / E`: 夜间极简 / 夜间霓虹
  - `P`: 开关课堂展示模式
- 导航页把鼠标停留在卡片上会预加载场景，减少首次进入等待。
- 主题风格会自动记忆，下次打开保持上次选择。
- 动画暂停时会切到按需渲染，降低课堂待机功耗与风扇噪声。

## 适合课堂的讲解节奏（建议）

1. 先展示结构（静态暂停，旋转观察器件）。
2. 再单独改一个参数，观察现象变化。
3. 最后切换到典型函数或预设，对比不同结果。

## 给技术支持同事（可选）

```bash
npm test        # 运行测试
npm run test:roundtrip # 桌面端导航往返回归（进入各演示并返回）
npm run test:touch # 触屏回归（输出到 output/playwright/touch-regression）
npm run test:e2e # 一次执行桌面往返 + 触屏手势回归
npm run test:perf # 构建并校验首页未预加载 three/r3f 重依赖
npm run build   # 打包检查
npm run preview # 本地预览打包结果
```

首次运行触屏回归前建议执行：

```bash
npx playwright install chromium
```

新增演示页时可参考课堂展示接入模板：

- `docs/presentation-signal-playbook.md`

---

如果你是任课老师，只需要记住两件事:  
先选实验，再改参数。其余交给 3D 场景本身去“说话”。
